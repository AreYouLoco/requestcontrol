<!-- This Source Code Form is subject to the terms of the Mozilla Public
   - License, v. 2.0. If a copy of the MPL was not distributed with this
   - file, You can obtain one at http://mozilla.org/MPL/2.0/. -->
<!DOCTYPE html>
<html>

<head>
    <meta charset="utf-8">
    <link rel="stylesheet" href="bootstrap/css/bootstrap.min.css">
    <link rel="stylesheet" href="tags-input/tags-input.css">
    <link rel="stylesheet" href="options.css">
    <script src="tags-input/tags-input.js"></script>
    <script src="OptionsManager.js"></script>
    <script src="options.js"></script>
</head>

<body>
<div class="container">
    <h2 class="page-header">Request Control Panel</h2>
    <p>Define rules for controlling HTTP requests.</p>
    <div class="panel panel-default">
        <div class="panel-heading">
            <h3 class="panel-title">
                <a id="showHelp" data-toggle="collapse" href="#help" class="text-info">
                    <span class="glyphicon glyphicon-question-sign"></span> Show Help
                </a>
            </h3>
        </div>
        <div id="help" class="panel-collapse collapse hidden">
            <div class="panel-body">
                <div class="container-fluid">
                    <h2 class="page-header">Request Control Rule</h2>
                    <p>Request Control Rule consists of <i>request pattern</i>, <i>request types</i> and <i>rule
                        action</i>. Any request that matches a pattern of an active rule, will be intercepted taking the
                        action of the rule.
                    </p>
                </div>
                <div class="container-fluid">
                    <h2 class="page-header">Request Pattern</h2>
                    <p>Request pattern contains three parts: <i>scheme</i>, <i>host</i> and <i>path</i>.</p>
                    <h3>Scheme</h3>
                    <p>Scheme matches the protocol of the request URL. It can be set to match schemes in the following
                        ways.</p>
                    <table class="table">
                        <tbody>
                        <tr>
                            <td><i>http</i></td>
                            <td>Match http scheme.</td>
                        </tr>
                        <tr>
                            <td><i>https</i></td>
                            <td>Match https scheme.</td>
                        </tr>
                        <tr>
                            <td><i>http/https</i></td>
                            <td>Match both http and https schemes.</td>
                        </tr>
                        </tbody>
                    </table>
                    <h3>Host</h3>
                    <p>Host matches the host of the request URL. It can be in one of the following forms. </p>
                    <table class="table">
                        <tbody>
                        <tr>
                            <td><i>www.example.com</i></td>
                            <td>Match a complete host.</td>
                            <td></td>
                        </tr>
                        <tr>
                            <td><i>example.com</i></td>
                            <td>Match the given host and any of its subdomains.</td>
                            <td>Check the include subdomains checkbox to match any subdomain (e.g.
                                <i><strong>www</strong>.example.com</i>,
                                <i><strong>good</strong>.example.com</i> and any other subdomain of example.com).
                            </td>
                        </tr>
                        <tr>
                            <td><i>www.example.*</i></td>
                            <td>Match the given host and all of the listed top-level domains. (can be combined with
                                the subdomain matching)
                            </td>
                            <td>Write the top-level domains to the top-level domain name list (e.g. <i>com</i>,
                                <i>org</i>).
                            </td>
                        </tr>
                        <tr>
                            <td><i>*</i></td>
                            <td>Match any host.</td>
                            <td></td>
                        </tr>
                        </tbody>
                    </table>
                    <h3>Path</h3>
                    <p>Path matches the request URL path. Path may subsequently contain any
                        combination of "*" wildcard and any of the characters that are allowed in URL paths. The "*"
                        wildcard matches any portion of path and may appear more than once. Below is examples for using
                        path patterns.
                    </p>
                    <table class="table">
                        <tbody>
                        <tr>
                            <td>*</td>
                            <td>Match any path.</td>
                        </tr>
                        <tr>
                            <td><i>path/a/b/</i></td>
                            <td>Match exact path "path/a/b/".</td>
                        </tr>
                        <tr>
                            <td><i>*/b/*</i></td>
                            <td>Match path that contains a component "b" somewhere in the middle.</td>
                        </tr>
                        </tbody>
                    </table>
                </div>
                <div class="container-fluid">
                    <h2 class="page-header">Request Types</h2>
                    <p>Filter requests based on the type of the request. A type represents the requested resource. Rule
                        can apply from one to many types or any type. All the possible types are listed below.</p>
                    <ul>
                        <li>Document</li>
                        <li>Embedded document</li>
                        <li>Stylesheet</li>
                        <li>Script</li>
                        <li>Image</li>
                        <li>Object</li>
                        <li>XMLHttpRequest</li>
                        <li>XBL</li>
                        <li>XSLT</li>
                        <li>Font</li>
                        <li>Media</li>
                        <li>WebSocket</li>
                        <li>CSP report</li>
                        <li>Imageset</li>
                        <li>Web Manifest</li>
                        <li>Other</li>
                        <li>Any Type</li>
                    </ul>
                </div>
                <div class="container-fluid">
                    <h2 class="page-header">Rule Action</h2>
                    <p>There are four possible actions for rules.</p>
                    <table class="table">
                        <tbody>
                        <tr>
                            <td><img src="../icons/icon-filter@19.png"></td>
                            <td>Filter Requests</td>
                            <td>Skips redirection tracking. If the matched request URL contains another URL, the request
                                is cancelled and the tab where the request was made is navigated to the contained
                                URL. Additionally URL tracking parameters that are defined in the filtered parameters
                                list will be removed.
                            </td>
                        </tr>
                        <tr>
                            <td><img src="../icons/icon-block@19.png"></td>
                            <td>Block Requests</td>
                            <td>Any request that matches a block rule will be cancelled before it is made.</td>
                        </tr>
                        <tr>
                            <td><img src="../icons/icon-redirect@19.png"></td>
                            <td>Redirect Requests</td>
                            <td>Any request that matches a redirect rule will be redirected to the given redirect URL.
                            </td>
                        </tr>
                        <tr>
                            <td><img src="../icons/icon-whitelist@19.png"></td>
                            <td>Whitelist Requests</td>
                            <td>Any request that matches a whitelist rule will be processed normally without taking any
                                action of any other matched rules.
                            </td>
                        </tr>
                        </tbody>
                    </table>
                </div>
            </div>
        </div>
    </div>
    <ul id="rules" class="list-group form-horizontal"></ul>
    <ul id="whitelist" class="list-group form-horizontal"></ul>
    <button id="addNewRule" class="btn btn-default"><span class="glyphicon glyphicon-plus"></span> Create new rule
    </button>
    <button id="restoreRules" class="btn btn-link pull-right">Restore Defaults</button>
    <h3 class="page-header">Configure URL parameters filtering</h3>
    <p>Set URL parameters that will be removed from requests that match a "Filter" rule. URL parameters
        are commonly used in redirection tracking as a method to analyze the origin of traffic.</p>
    <div class="form-group">
        <input id="queryParams" type="tags" class="form-control input-sm input-params params"/>
    </div>
    <label id="saveParamsSuccess" class="text-success text-saved">
        <span class="glyphicon glyphicon-ok"></span> parameters saved
    </label>
    <button id="restoreParams" class="btn btn-link pull-right">Restore Defaults</button>
</div>

<ul id="models" class="list-group form-horizontal hidden">
    <li id="ruleInputModel" class="list-group-item rule">
        <div class="row">
            <div class="col-md-6">
                <img class="icon" src="" alt="">
                <label class="title">New rule</label><br/>
                <small class="description"></small>
            </div>
            <div class="col-md-6">
                <span class="pull-right">
                    <button type="button" class="btn btn-default btn-edit">Edit
                    </button>
                    <button type="button" class="btn btn-default btn-activate">Disable
                    </button>
                </span>
            </div>
        </div>
        <div class="panel-collapse collapse hidden">
            <div class="form-group">
                <div class="col-sm-2 control-label">
                    <div class="row no-gutter">
                        <div class="col-sm-12">
                            <label class="help-block">&#8203;</label>
                            <label>Pattern</label>
                        </div>
                    </div>
                </div>
                <div class="col-sm-10">
                    <div class="row no-gutter">
                        <div class="col-xs-3 col-md-2">
                            <label for="scheme" class="help-block text-center">scheme://</label>
                            <div class="input-group input-group-sm">
                                <div class="input-group-btn" style="width:auto;">
                                    <select id="scheme" class="form-control input-sm scheme text-center">
                                        <option value="http">http</option>
                                        <option value="https">https</option>
                                        <option value="*" selected>http/https</option>
                                    </select>
                                </div>
                                <span class="input-group-addon"><strong>://</strong></span>
                            </div>
                        </div>
                        <div class="col-xs-5 col-md-6">
                            <label for="host" class="help-block text-center">host</label>
                            <div class="input-group input-group-sm">
                                <span class="input-group-addon">
                                    <input class="matchSubDomains" type="checkbox" title="Include subdomains"
                                           style="vertical-align:middle;">
                                </span>
                                <input id="host" type="text" class="form-control input-sm host"
                                       placeholder="example.com"
                                       pattern="^(\*|(([a-zA-Z0-9]|[a-zA-Z0-9][a-zA-Z0-9\-]*[a-zA-Z0-9])\.)*([A-Za-z0-9]|[A-Za-z0-9][A-Za-z0-9\-]*[A-Za-z0-9])(\.\*)?)$"/>
                                <div class="input-group-btn hidden">
                                    <button class="btn btn-info btn-tlds" type="button"
                                            title="Included top-level domain names">
                                        <span>TLDs </span><span class="badge">0</span>
                                    </button>
                                </div>
                            </div>
                        </div>
                        <div class="col-xs-4  col-md-4">
                            <label for="path" class="help-block text-center">path</label>
                            <div class="input-group input-group-sm">
                                <span class="input-group-addon"><strong>/</strong></span>
                                <input id="path" type="text" class="form-control input-sm path" placeholder="path"
                                       pattern="^[!#-;=?-[\]_-z~]*$"/>
                            </div>
                        </div>
                    </div>
                    <div class="tlds-block hidden">
                        <label for="tlds" class="help-block">Top-level domains</label>
                        <input id="tlds" type="tags" class="form-control input-sm input-tlds tlds hidden"/>
                    </div>
                </div>
            </div>
            <div class="form-group">
                <label class="col-sm-2 control-label">Types</label>
                <div class="col-sm-10">
                    <div class="row no-gutter">
                        <div class="col-xs-3 col-md-2">
                            <div class="btn-group btn-group-justified btn-group-sm" data-toggle="buttons">
                                <label class="btn btn-default">
                                    <input class="any-type" type="checkbox" autocomplete="off">Any type
                                </label>
                            </div>
                        </div>
                        <div class="col-xs-8 col-md-7">
                            <div class="btn-toolbar">
                                <div class="btn-group btn-group-sm btn-group-types" data-toggle="buttons">
                                    <label class="btn btn-default">
                                        <input value="main_frame" type="checkbox" autocomplete="off" class="type">Document
                                    </label>
                                    <label class="btn btn-default">
                                        <input value="sub_frame" type="checkbox" autocomplete="off" class="type">Embedded
                                        document
                                    </label>
                                    <label class="btn btn-default">
                                        <input value="stylesheet" type="checkbox" autocomplete="off" class="type">Stylesheet
                                    </label>
                                    <label class="btn btn-default">
                                        <input value="script" type="checkbox" autocomplete="off" class="type">Script
                                    </label>
                                    <label class="btn btn-default">
                                        <input value="image" type="checkbox" autocomplete="off" class="type">Image
                                    </label>
                                    <label class="btn btn-default hidden">
                                        <input value="object" type="checkbox" autocomplete="off"
                                               class="type extra-type">Object
                                    </label>
                                    <label class="btn btn-default hidden">
                                        <input value="xmlhttprequest" type="checkbox" autocomplete="off"
                                               class="type extra-type">XMLHttpRequest
                                    </label>
                                    <label class="btn btn-default hidden">
                                        <input value="xbl" type="checkbox" autocomplete="off" class="type extra-type">XBL
                                    </label>
                                    <label class="btn btn-default hidden">
                                        <input value="xslt" type="checkbox" autocomplete="off" class="type extra-type">XSLT
                                    </label>
                                    <label class="btn btn-default hidden">
                                        <input value="font" type="checkbox" autocomplete="off" class="type extra-type">Font
                                    </label>
                                    <label class="btn btn-default hidden">
                                        <input value="media" type="checkbox" autocomplete="off" class="type extra-type">Media
                                    </label>
                                    <label class="btn btn-default hidden">
                                        <input value="websocket" type="checkbox" autocomplete="off"
                                               class="type extra-type">WebSocket
                                    </label>
                                    <label class="btn btn-default hidden">
                                        <input value="csp_report" type="checkbox" autocomplete="off"
                                               class="type extra-type">CSP report
                                    </label>
                                    <label class="btn btn-default hidden">
                                        <input value="imageset" type="checkbox" autocomplete="off"
                                               class="type extra-type">Imageset
                                    </label>
                                    <label class="btn btn-default hidden">
                                        <input value="web_manifest" type="checkbox" autocomplete="off"
                                               class="type extra-type">Web Manifest
                                    </label>
                                    <label class="btn btn-default hidden">
                                        <input value="other" type="checkbox" autocomplete="off" class="type extra-type">Other
                                    </label>
                                    <label class="btn btn-default">
                                        <input class="more-types" type="checkbox" autocomplete="off"><span class="text">More ▸</span>
                                    </label>
                                </div>
                            </div>
                        </div>
                    </div>
                </div>
            </div>
            <div class="form-group">
                <label for="action" class="col-sm-2 control-label">Action</label>
                <div class="col-sm-3 col-md-2">
                    <select id="action" class="form-control input-sm action">
                        <option value="filter">Filter Request</option>
                        <option value="block">Block Request</option>
                        <option value="redirect">Redirect Request</option>
                        <option value="whitelist">Whitelist Request</option>
                    </select>
                </div>
                <div class="col-sm-7 col-md-8">
                    <div class="input-group hidden">
                        <span class="input-group-addon">Redirect URL</span>
                        <input type="text" class="form-control input-sm redirectUrl hidden" placeholder="Redirect URL"
                               pattern="^.+:\/\/[^\s/$.?#].[^\s]*$"/>
                    </div>
                </div>
            </div>
            <div class="form-group">
                <label class="col-sm-2 control-label text-success text-saved">
                    <span class="glyphicon glyphicon-ok"></span> saved
                </label>
                <div class="col-sm-10">
                    <button type="button" class="btn btn-sm btn-primary btn-save">Save rule
                    </button>
                    <span class="pull-right">
                    <button type="button" class="btn btn-sm btn-danger btn-remove"><span
                            class="glyphicon glyphicon-trash"></span> Remove</button>
                    </span>
                </div>
            </div>
        </div>
    </li>
</ul>

</body>

</html>
